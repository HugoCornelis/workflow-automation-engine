# The Workflow Automation Engine

The workflow automation engine helps automating complicated system
shell tasks during the development of a software project.

Typical examples of workflow automation are shell commands to compile
source code on a build server or convert documentation to a web page
where these commands take arguments and options that are hard to
remember.

Other examples are commands to flash a binary image such as the Linux
kernel to a small or embedded device.

## Overview

The workflow automation engine offers the following functions:

- Easy to start a new project, new _targets_ and new _commands_.
- Integration with `bash` completion allows browsing project specific
  _targets_, project specific _commands_ and project specific
  _configuration_.
- Integration with `grc` for project specific _keyword highlighting_.
- Support for different _roles_ that allows remote execution, in a
  Docker container or a `tmux` session.

## Installation

### Prerequisites

The workflow automation engine uses `grc` for colorification of the
output and relies on [YAML](https://yaml.org/) for configuration
files.  It also has a dependency on the `File::chdir` perl module and
installation itself is done with `make`.

As an example, for an Ubuntu 22.04.3 LTS jammy, install these prerequisites:

```
sudo apt install grc
sudo apt install libyaml-perl
sudo apt install libfile-chdir-perl
sudo apt install automake
sudo apt install make
```

The installation is then done through the provided tarball (see
below).

If you prefer to install directly from the `github` repository, you
also need `automake` as a prerequisite:

```
sudo apt install automake
```


### Installation from a Tarball

Installation from a tarball installs the latest available release that
was considered 'stable' by the developer team.  The tarball can be
downloaded from:

https://github.com/HugoCornelis/workflow-automation-engine/raw/master/workflow-automation-0.1.0-alpha.tar.gz

Use `tar` to unpack followed with `configure` and `make` to install:

```
tar xf workflow-automation-0.1.0-alpha.tar.gz
./configure
make
sudo make install
```

### Installation from the `github` Repository

First clone the repository into a local directory:

```
git clone https://github.com/HugoCornelis/workflow-automation-engine.git
cd workflow-automation-engine
```

The `configure` script is not available from the `github` repository.
To generate it, issue the command:

```
./autogen.sh
```

Then install the engine using `configure` and `make`:

```
./configure
make
sudo make install
```

After installation, it is useful to know a few things about the
automated configuration of projects before starting one.


### Configuration

After installation new projects can be created.

Each project has separate configuration for `grc` and `bash`
(completion).  The configuration of `grc` is found in its regular
configuration directory (see the man page of `grc` for more
information) and shell aliases make sure `grc` is invoked
appropriately.

`bash` completion is dynamically generated by the workflow automation
engine when it is needed (when the user hits the <tab> key).

The `bash` completion script is generated automatically upon workflow
engine project creation (see below) and its invocation added to your
`.bashrc` file.

Combined this leads to this configuration in your `.bashrc` file for
each project:

```
alias neurospaces-workflow="grc neurospaces-workflow"
alias neurospaces-configuration="grc neurospaces-configuration"

. ~/projects/developer/source/snapshots/master/bin/workflow-files/neurospaces-bash-completion.sh
```

Note that this configuration is automatically generated.


## Starting a new project

Starting a new workflow project with name *abcd* consists of these
steps:

1. `workflow builtin start_project abcd`

	Creates a workflow configuration for a new project with name
    *abcd*.

2. `mv workflow-project-template.pl workflow-project.pl`

	Renames the template project file such that the workflow engine
	recognizes it.

3. `workflow builtin install_scripts -- --engine --commands --git`

	Makes the configuration available from any directory.

4. `abcd-workflow --help-commands`

	Optionally shows the available commands for the project with name
    *abcd*.

5. `abcd-workflow examples_sh sh_single_command`

	By default the workflow engine installs a few commands that you
    can easily adapt to your needs.  This is one of them.  Use the
    `--dry-run` option to see exactly what commands would be executed,
    use the `--interactions` option to see the same commands based on
    the role which would execute them.

6. `abcd-workflow builtin add_target -- xyz "Add commands to this new target that do new things" --install-commands-sh`

	Adds the target *xyz* and creates a directory with a few template
    examples for you to adapt to your project.

